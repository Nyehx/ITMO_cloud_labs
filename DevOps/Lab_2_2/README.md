# Лабораторная №2_*

## Задание
- Написать “плохой” Docker Compose файл, в котором есть не менее трех “bad practices” по их написанию.
- Написать “хороший” Docker Compose файл, в котором эти плохие практики исправлены.
- В Readme описать каждую из плохих практик в плохом файле, почему она плохая и как в хорошем она была исправлена, как исправление повлияло на результат.
- После предыдущих пунктов в хорошем файле настроить сервисы так, чтобы контейнеры в рамках этого compose-проекта так же поднимались вместе, но не "видели" друг друга по сети. В отчете описать, как этого добились и кратко объяснить принцип такой изоляции.

## Установка Docker Compose
Первым делом устанавливаем Docker на операционную систему. В нашем случае это Linux, а именно AstraLinux:2.12.46, запущенная через VirtualBox. Для того чтобы установить Docker, нужно открыть терминал ввести команды:
* sudo apt update
* sudo apt install docker-compose

## Написание Docker-Compose file

Для того, чтобы запустить докеры, нужно ввести следующие команды в нужных директориях:

* sudo docker-compose up .

Покажем, что наши контейнеры на самом деле работают, и выыполняют то, что написано в bash.md.

![net](https://github.com/Nyehx/ITMO_cloud_labs/blob/main/DevOps/Lab_2_2/1.png)

![net](https://github.com/Nyehx/ITMO_cloud_labs/blob/main/DevOps/Lab_2_2/2.png)

Успешно собран и запущен плохой и хороший контейнеры.

### Плохой Dockerfile

Сначала опишем, какие "плохие практики" были использованы при первоначальном написании докерфайла.

1. Первая "плохая практика" - не указана конкретная версия базового образа. 

* FROM ubuntu:latest

В данном примере в качестве базового образа для докера используется ubuntu последней версии. Последняя версия может измениться, и написанный докерфайл может перестать работать в более новых версиях.

2. Вторая "плохая практика" заключается в том, что мы запускаем все процессы от имени пользователя root.

3. Третья "плохая практика" - использование COPY . /app, что приводит к копированию всех файлов из текущей директории, а это увеличивает размер контейнера.


### Хороший Dockerfile

По порядку опишем, какие решения были приняты для исправления ошибок. Так же опишем, как исправление ошибок повлияло на реузльтат.

1. Укажем конкретную версию, для которой будет работать наш Docker.

* FROM ubuntu:20.04

Независимо от внешних источников, Docker всегда будет запускаться одинаково и будет стабилен через некторое время - это "хорошая практика".

2. Мы создаем и используем ограниченного пользователя.
* RUN useradd -m myuser USER myuser
3. Так же в хорошем докерфайле мы копируем только необходимый файл, в данном случае только start.sh
* COPY start.sh /app/start.sh
 


## Результаты

Теперь подведём небольшие итоги. 

1. Был написан "плохой" докерфайл. В нем были использованы 3 "плохих" практики. Все 3 "плохие" практики описаны.
2. Был написан "хороший" докерфайл. В нем были исправлены возникшие ранее "плохие" практики. Так же мы описали каждое решение, и как оно повлияет на сам Docker.
3. Мы описали 4 "плохие" практики при работе с контейнерами.

## Работу выполнили
* Буцкий Даниил
* Корчагин Роман
